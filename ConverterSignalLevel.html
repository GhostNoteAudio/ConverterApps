<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>
        

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
        
        <style>
            body {
                font-family: "Open Sans";
                background-color: #efecec;
            }
            h2 {
                font-size: 18pt;
                margin-top: 25px;
                margin-bottom: 15px;
            }

            h2 i {
                font-size: 14pt;
                position:relative;
                top: -2px;
            }

            p {
                color: #666;
            }
            input[type=text] {
                padding: 2px;
                margin: 2px;
            }

            input[type=button] {
                padding:3px;
            }
            #sysex-textarea, #monitor-textarea {
                width: 100%; 
                height: 140px;
                margin-bottom: 5px;
                padding: 5px;
                font-family: "JetBrains Mono";
                font-size: 10pt;
            }

            #master-div {
                max-width: 500px;
                background: #ddd;
                margin: 0 auto;
                padding: 20px;
                border-radius: 20px;
                margin-top: 0px;
                transform-origin: 50% 0%;
            }

            label {
                display: block;
                width: 100%;
            }

            .x3-input {padding: 5px 2px; }
            .x3-input h3 { display:inline-block; width: 20%; margin:0; font-size: 12pt; }
            .x3-input p { display:inline-block; width: 18%; margin:0; font-size: 8pt; }

            .x3-input select, .x3-input input { width: calc(25%); margin: 2px 5px; }

            .tooltip > .tooltip-inner {
                background-color: rgb(42, 45, 53);
            }

            .mode-tooltip > .tooltip-inner {
                text-align: left;
                max-width: 550px;
            }

        </style>

        <script type="text/javascript">

            let model = {
                VPeak: 1.0,
                VP2P: 2.0,
                VRms: 0.707,
                Dbu: 0.0,
                Dbv: 0.0
            };

            function setValues(newValue, source) {
                if (source === "v-rms") model.VPeak = newValue * Math.sqrt(2);
                else if (source === "v-peak") model.VPeak = newValue;
                else if (source === "v-p2p") model.VPeak = newValue / 2;
                else if (source === "dbu") model.VPeak = 0.77459667 * Math.pow(10, newValue / 20) * Math.sqrt(2);
                else if (source === "dbv") model.VPeak = Math.pow(10, newValue / 20) * Math.sqrt(2);

                model.VP2P = model.VPeak * 2;
                model.VRms = model.VPeak / Math.sqrt(2);
                model.Dbu = 20 * Math.log10(model.VRms / 0.77459667);
                model.Dbv = 20 * Math.log10(model.VRms);
            }

            function updateModel(ev) {
                let source = (!ev) ? "v-peak" : ev.target.id;
                let valueText = $("#"+source).val();
                console.log("Updating " + source + " as " + valueText);

                let valueFloat = parseFloat(valueText);
                
                // validate
                if (isNaN(valueFloat)) return;
                if (source === "dbu" || source === "dbv")
                {
                    if (!(valueFloat >= -1000 && valueFloat < 1000)) return;
                }
                else
                {
                    if (!(valueFloat >= 0)) return;
                }
                
                setValues(valueFloat, source);
                updateUi(source);
            }

            function updateUi(sourceId) {
                // don't update the sourceId!

                if (sourceId != 'v-peak') $('#v-peak').val(Number(model.VPeak.toFixed(3)));
                if (sourceId != 'v-p2p') $('#v-p2p').val(Number(model.VP2P.toFixed(3)));
                if (sourceId != 'v-rms') $('#v-rms').val(Number(model.VRms.toFixed(3)));
                if (sourceId != 'dbu') $('#dbu').val(Number(model.Dbu.toFixed(3)));
                if (sourceId != 'dbv') $('#dbv').val(Number(model.Dbv.toFixed(3)));
            }

            // ----------------- Button Handlers ---------------

            $(window).on('load', () => {
                $(':input[type="text"]').change(updateModel);
                $(':input[type="text"]').on('input', updateModel);
                updateModel();

                if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
                    let scaleValue = ($(window).width()) / 500.0;
                    $('#master-div').css("scale", scaleValue);
                }

                const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
                const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
            });
        </script>
    </head>
    <body>
        <div id="master-div">
            <svg
                style="width: 60%; opacity: 0.7;"
                width="135mm"
                height="22mm"
                viewBox="0 0 135 33"
                version="1.1"
                id="svg1005"
                inkscape:version="1.1.1 (3bf5ae0d25, 2021-09-20)"
                sodipodi:docname="logo.svg"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:svg="http://www.w3.org/2000/svg">
                <sodipodi:namedview
                    id="namedview1007"
                    pagecolor="#ffffff"
                    bordercolor="#666666"
                    borderopacity="1.0"
                    inkscape:pageshadow="2"
                    inkscape:pageopacity="0.0"
                    inkscape:pagecheckerboard="0"
                    inkscape:document-units="mm"
                    showgrid="false"
                    inkscape:zoom="1.8116734"
                    inkscape:cx="310.76241"
                    inkscape:cy="261.91254"
                    inkscape:window-width="2560"
                    inkscape:window-height="1537"
                    inkscape:window-x="-8"
                    inkscape:window-y="-8"
                    inkscape:window-maximized="1"
                    inkscape:current-layer="layer1" />
                <defs
                    id="defs1002" />
                <g
                    inkscape:label="Layer 1"
                    inkscape:groupmode="layer"
                    id="layer1">
                    <g
                    id="g1245"
                    transform="translate(-0.31343726,-0.49619785)">
                    <g
                        id="Layer2"
                        transform="matrix(0.26458333,0,0,0.26458333,-84.797618,-99.808535)"
                        style="clip-rule:evenodd;fill-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2">
                        <g
                        transform="translate(45.9056,13)"
                        id="g22">
                        <g
                            transform="matrix(50,0,0,50,340.961,425.835)"
                            id="g4">
                            <path
                            d="m 0.063,-0.359 c 0,0.226 0.133,0.371 0.346,0.371 0.087,0 0.171,-0.024 0.231,-0.065 V -0.35 H 0.382 v 0.033 h 0.221 v 0.244 c -0.045,0.03 -0.116,0.05 -0.194,0.05 -0.19,0 -0.306,-0.131 -0.306,-0.336 0,-0.19 0.124,-0.318 0.306,-0.318 0.073,0 0.144,0.018 0.198,0.052 l 0.02,-0.031 C 0.566,-0.693 0.489,-0.712 0.409,-0.712 c -0.206,0 -0.346,0.142 -0.346,0.353 z"
                            style="fill-rule:nonzero"
                            id="path2" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,392.111,425.835)"
                            id="g8">
                            <path
                            d="m 0.093,0 h 0.039 v -0.339 h 0.43 V 0 H 0.601 V -0.7 H 0.562 v 0.326 H 0.132 V -0.7 H 0.093 Z"
                            style="fill-rule:nonzero"
                            id="path6" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,441.811,425.835)"
                            id="g12">
                            <path
                            d="m 0.063,-0.356 c 0,0.229 0.149,0.368 0.34,0.368 0.192,0 0.341,-0.139 0.341,-0.368 0,-0.216 -0.153,-0.356 -0.341,-0.356 -0.187,0 -0.34,0.14 -0.34,0.356 z m 0.04,0 c 0,-0.194 0.136,-0.321 0.3,-0.321 0.165,0 0.301,0.127 0.301,0.321 0,0.208 -0.132,0.333 -0.301,0.333 -0.168,0 -0.3,-0.125 -0.3,-0.333 z"
                            style="fill-rule:nonzero"
                            id="path10" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,496.211,425.835)"
                            id="g16">
                            <path
                            d="m 0.059,-0.056 c 0.051,0.035 0.142,0.068 0.244,0.068 0.163,0 0.239,-0.08 0.239,-0.185 0,-0.277 -0.431,-0.123 -0.431,-0.358 0,-0.084 0.07,-0.146 0.188,-0.146 0.084,0 0.151,0.023 0.198,0.047 l 0.017,-0.033 c -0.05,-0.026 -0.122,-0.049 -0.216,-0.049 -0.143,0 -0.227,0.079 -0.227,0.181 0,0.273 0.431,0.125 0.431,0.358 0,0.085 -0.063,0.15 -0.199,0.15 -0.093,0 -0.176,-0.032 -0.223,-0.065 z"
                            style="fill-rule:nonzero"
                            id="path14" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,540.911,425.835)"
                            id="g20">
                            <path
                            d="M 0.3,0 H 0.339 V -0.664 H 0.608 V -0.7 H 0.032 v 0.036 H 0.3 Z"
                            style="fill-rule:nonzero"
                            id="path18" />
                        </g>
                        </g>
                        <g
                        transform="translate(311.3,13)"
                        id="g40">
                        <g
                            transform="matrix(50,0,0,50,340.961,425.835)"
                            id="g26">
                            <path
                            d="M 0.093,0 H 0.131 V -0.649 L 0.572,0 H 0.621 V -0.7 H 0.582 v 0.65 L 0.141,-0.7 H 0.093 Z"
                            style="fill-rule:nonzero"
                            id="path24" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,391.661,425.835)"
                            id="g30">
                            <path
                            d="m 0.063,-0.356 c 0,0.229 0.149,0.368 0.34,0.368 0.192,0 0.341,-0.139 0.341,-0.368 0,-0.216 -0.153,-0.356 -0.341,-0.356 -0.187,0 -0.34,0.14 -0.34,0.356 z m 0.04,0 c 0,-0.194 0.136,-0.321 0.3,-0.321 0.165,0 0.301,0.127 0.301,0.321 0,0.208 -0.132,0.333 -0.301,0.333 -0.168,0 -0.3,-0.125 -0.3,-0.333 z"
                            style="fill-rule:nonzero"
                            id="path28" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,444.311,425.835)"
                            id="g34">
                            <path
                            d="M 0.3,0 H 0.339 V -0.664 H 0.608 V -0.7 H 0.032 v 0.036 H 0.3 Z"
                            style="fill-rule:nonzero"
                            id="path32" />
                        </g>
                        <g
                            transform="matrix(50,0,0,50,491.311,425.835)"
                            id="g38">
                            <path
                            d="M 0.093,0 H 0.56 V -0.035 H 0.132 V -0.34 h 0.38 V -0.374 H 0.132 V -0.665 H 0.553 V -0.7 h -0.46 z"
                            style="fill-rule:nonzero"
                            id="path36" />
                        </g>
                        </g>
                        <g
                        transform="translate(-143.088,-77.0207)"
                        id="g62">
                        <g
                            transform="matrix(37.5,0,0,37.5,531.655,579.153)"
                            id="g44">
                            <path
                            d="M 0.04,0 0.315,-0.7 H 0.349 L 0.623,0 H 0.595 L 0.515,-0.208 H 0.148 L 0.068,0 Z M 0.331,-0.683 0.156,-0.23 H 0.507 L 0.333,-0.683 Z"
                            style="fill-rule:nonzero"
                            id="path42" />
                        </g>
                        <g
                            transform="matrix(37.5,0,0,37.5,566.755,579.153)"
                            id="g48">
                            <path
                            d="M 0.093,-0.252 V -0.7 h 0.024 v 0.448 c 0,0.076 0.023,0.135 0.068,0.178 0.045,0.043 0.101,0.064 0.169,0.064 0.068,0 0.124,-0.021 0.17,-0.064 0.045,-0.043 0.067,-0.102 0.067,-0.178 V -0.7 h 0.024 v 0.448 c 0,0.084 -0.025,0.149 -0.074,0.195 C 0.492,-0.011 0.429,0.012 0.354,0.012 0.279,0.012 0.216,-0.011 0.167,-0.057 0.118,-0.103 0.093,-0.168 0.093,-0.252 Z"
                            style="fill-rule:nonzero"
                            id="path46" />
                        </g>
                        <g
                            transform="matrix(37.5,0,0,37.5,604.555,579.153)"
                            id="g52">
                            <path
                            d="m 0.096,0 v -0.7 h 0.178 c 0.117,0 0.207,0.03 0.269,0.09 0.062,0.06 0.093,0.143 0.093,0.25 0,0.115 -0.03,0.203 -0.091,0.266 C 0.484,-0.031 0.394,0 0.274,0 Z M 0.12,-0.022 h 0.154 c 0.112,0 0.196,-0.029 0.253,-0.089 C 0.584,-0.17 0.612,-0.253 0.612,-0.36 0.612,-0.459 0.583,-0.537 0.525,-0.594 0.467,-0.65 0.383,-0.678 0.274,-0.678 H 0.12 Z"
                            style="fill-rule:nonzero"
                            id="path50" />
                        </g>
                        <g
                            transform="matrix(37.5,0,0,37.5,642.13,579.153)"
                            id="g56">
                            <rect
                            x="0.096000001"
                            y="-0.69999999"
                            width="0.024"
                            height="0.69999999"
                            style="fill-rule:nonzero"
                            id="rect54" />
                        </g>
                        <g
                            transform="matrix(37.5,0,0,37.5,661.48,579.153)"
                            id="g60">
                            <path
                            d="m 0.066,-0.356 c 0,-0.105 0.033,-0.191 0.098,-0.257 0.065,-0.066 0.144,-0.099 0.239,-0.099 0.095,0 0.175,0.033 0.24,0.099 0.065,0.066 0.097,0.152 0.097,0.257 0,0.112 -0.032,0.201 -0.095,0.268 -0.064,0.067 -0.145,0.1 -0.242,0.1 -0.097,0 -0.178,-0.033 -0.241,-0.1 C 0.098,-0.155 0.066,-0.244 0.066,-0.356 Z m 0.024,0 c 0,0.105 0.03,0.189 0.089,0.252 0.059,0.063 0.134,0.094 0.224,0.094 0.09,0 0.165,-0.031 0.224,-0.094 0.059,-0.063 0.089,-0.147 0.089,-0.252 0,-0.099 -0.03,-0.179 -0.091,-0.241 C 0.564,-0.659 0.49,-0.69 0.403,-0.69 0.316,-0.69 0.242,-0.659 0.181,-0.597 0.12,-0.535 0.09,-0.455 0.09,-0.356 Z"
                            style="fill-rule:nonzero"
                            id="path58" />
                        </g>
                        </g>
                    </g>
                    <g
                        id="path2986-1"
                        transform="matrix(0.1102741,0,0,0.1102741,-35.262036,-41.191051)"
                        style="clip-rule:evenodd;fill-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2">
                        <path
                        d="m 414.37,453.28 c -0.271,22.337 -37.865,44.111 -36.624,83.655 0.784,24.977 27.218,57.436 46.03,80.952 -9.406,-4.703 -18.817,-9.012 -32.921,-9.406 -28.303,-0.79 -43.029,18.259 -37.624,37.624 4.178,14.969 8.23,19.646 14.109,28.218 -30.171,-16.426 -47.184,-37.825 -44.443,-56.436 4.24,-28.795 30.891,-42.095 53.05,-39.976 -23.515,-23.515 -40.894,-47.468 -41.058,-70.31 -0.18,-25.172 25.103,-53.707 30.451,-67.429 2.527,-6.483 2.193,-12.322 2,-15.109 -1.341,-19.352 -9.406,-32.921 -14.109,-47.03 18.812,23.515 61.139,57.612 61.139,74.306 z"
                        id="path130" />
                    </g>
                    </g>
                </g>
            </svg>

            <div>
                <h2>Signal Level Conversion</h2>

                <b style="display:inline-block; margin-top: 5px; margin-bottom: 5px;" >Sinusoid waveform</b>

                <div class="x3-input">
                    <h3 data-bs-toggle="tooltip" data-bs-custom-class="mode-tooltip" data-bs-placement="right" data-bs-html="true" data-bs-title="Peak voltage, the highest instantaneous value it reaches.">V<sub>Peak</sub></h3>
                    <input id="v-peak" type="text" inputmode="decimal" min="0" max="1000000" value="1"></input>V
                </div>
                
                <div class="x3-input">
                    <h3 data-bs-toggle="tooltip" data-bs-custom-class="mode-tooltip" data-bs-placement="right" data-bs-html="true" data-bs-title="Peak to Peak - double the V<sub>Peak</sub> value.">V<sub>P2P</sub></h3>
                    <input id="v-p2p" type="text" inputmode="decimal" min="0" max="1000000" value="1"></input>V
                </div>    

                <div class="x3-input">
                    <h3 data-bs-toggle="tooltip" data-bs-custom-class="mode-tooltip" data-bs-placement="right" data-bs-html="true" data-bs-title="Root-mean-square (power) value of the waveform.">V<sub>RMS</sub></h3>
                    <input id="v-rms" type="text" inputmode="decimal" min="0" max="1000000" value="1"></input>V
                </div>    

                <div class="x3-input">
                    <h3 data-bs-toggle="tooltip" data-bs-custom-class="mode-tooltip" data-bs-placement="right" data-bs-html="true" data-bs-title="Relative to the RMS voltage which delivers 1 milliwatt into a 600-ohm resistor.">dB<sub>u</sub></h3>
                    <input id="dbu" type="text" inputmode="decimal" min="-1000" max="1000" value="0"></input>dBu
                </div>    

                <div class="x3-input">
                    <h3 data-bs-toggle="tooltip" data-bs-custom-class="mode-tooltip" data-bs-placement="right" data-bs-html="true" data-bs-title="Relative to 1 volt RMS, regardless of impedance.">dB<sub>V</sub></h3>
                    <input id="dbv" type="text" inputmode="decimal" min="-1000" max="1000" value="0"></input>dBV
                </div>    

                <h2>Useful Resources</h2>
                <ul>
                <li><a href="https://en.wikipedia.org/wiki/Decibel#Voltage">Wikipedia - Decibel</a></li>
                <li><a href="https://en.wikipedia.org/wiki/Root_mean_square">Wikipedia - Root Mean Square</a></li>
                </ul>
            </div>
        </div>
    </body>

    
</html>